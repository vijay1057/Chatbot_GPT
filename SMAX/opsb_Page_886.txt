Prepare persistent volumes for CMS
CMS installation in Helm mode requires the following Persistent Volumes (PVs). PVs are relevant to EFS volumes. 
Component
EFS volume name
Description
Example directory path
CMS
cms-data-volume
Stores data that's generated by CMS.
/var/vols/itom/cms/data_volume
CMS
cms-config-volume
Stores CMS configuration files.
/var/vols/itom/cms/conf_volume
CMS
cms-log-volume
Stores logs generated by CMS.
/var/vols/itom/cms/log_volume
If you already have the PVs available for use, you need to ensure that the storageClassName attribute of the PVs is the same
as the storage class name in the 
my-values.yaml
 file. In the later step, you will need to specify the name of PV to be bound
with one of the persistent volume claims (PVCs).
If you want to create the required PVs from scratch, perform the following tasks:
1
. 
Log in to the bastion node and navigate to the CMS chart package directory. For example:
cd CMS_Helm_Chart-202x.xx/cms-helm-charts/samples/
2
. 
Open the 
cms-pv.yaml
 file with a text editor, configure the following parameters, and then save the file.
<FQDN_Of_The_NFS_Server>
: EFS DNS name that you can get by navigating to 
AWS All services
 >
CloudFormation 
> 
Stacks 
> your EFS stack for CMS > 
output
, and then find 
FileServerDNSName
.
<NFS_directory path>
: EFS directory paths for the three EFS volumes required by CMS that you provided in
configureCMSEFS.sh 
when creating the EFS volumes for CMS, see 
Configure EFS for CMS
.
storageClassName
: The storage class name of the PV for CMS. For example, gp2. You can use the "
kubectl get
sc"
 command to see the storage class name.
3
. 
Run the following command to create persistent volumes:
kubectl create -f CMS_Helm_Chart-202x.xx/cms-helm-charts/samples/cms-pv.yaml
4
. 
Run the following command to verify the volume creation:
kubectl get pv | grep cms
Note
 Make sure that the directory path is corresponding to the persistent volume name. For example:
    apiVersion: v1
 kind: PersistentVolume
 metadata:
   name: cms-config-volume
 spec:
   accessModes:
   - ReadWriteMany
   capacity:
     storage: 5Gi
   nfs:
     path: /var/vols/itom/cms/conf_volume
     server: fs-58c3d35d.efs.us-west-2.amazonaws.com    


SMAX 2022.11
Page 
886
This PDF was generated on 25/02/2023 02:18:34 for your convenience. For the latest documentation, always see
https://docs.microfocus.com
.