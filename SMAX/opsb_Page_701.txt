Install two Nginx servers on different hosts, or on the same host.
One Nginx server for the suite and OMT (referred to as 
nginx-smax
). This Nginx server is used to handle requests
from end users accessing from the Internet,  and it can also be used in the URL of the integration with CMS. You need to
bind the external access host name that you have configured in the installation portal UI (see 
Select deployment
configuration
) to the IP address of this Nginx server.
One Nginx server for CMS (referred to as 
nginx-cms
).
Prepare certificates for each Nginx server
Prepare a server certificate and server key file (
server.crt
 and 
server.key
) separately for each of the two FQDNs, and use
CN=<access host> when generating the server certificate:
For 
nginx-smax
,
 
<access host> is the external access host name that's bound with the IP address of nginx-smax.
For 
nginx-cms
, <access host> is the CMS Nginx server host name.
Configure Nginx
Configure the Nginx servers as described below.
configure nginx-smax
Make sure the Nginx configuration file (nginx.conf) contains the following settings.
http {
    upstream management {     #upstream for management service
        least_conn;
        session_sticky;
        keepalive 32;
        server <control plane node 1>:5443 max_fails=3 fail_timeout=10s;     #control plane node 1
        server <control plane node 2>:5443 max_fails=3 fail_timeout=10s;     #control plane node 2
        server <control plane node 3>:5443 max_fails=3 fail_timeout=10s;     #control plane node 3
    } 
    upstream suite-service {     #upstream for suite service
        least_conn;
        session_sticky;
        keepalive 32;
        server <control plane node 1>:443 max_fails=3 fail_timeout=10s;     #control plane node 1
        server <control plane node 2>:443 max_fails=3 fail_timeout=10s;     #control plane node 2
        server <control plane node 3>:443 max_fails=3 fail_timeout=10s;     #control plane node 3
   }
   
    server { #listen on 5443 and proxy to management service
        listen 5443  ssl;
        ssl_protocols TLSv1.2;
        ssl_certificate                         /root/server.crt;       #certificate generated by customers
        ssl_certificate_key                  /root/server.key;      #key generated by customers 
        location ^~ / {
            proxy_set_header Host            "<external access host>:5443";
            proxy_pass                              https://management;
        }
    } 
server { #listen on 443 and proxy to suite service 
        listen 443 ssl;
        ssl_protocols TLSv1.2;
        ssl_certificate /root/server.crt; #certificate generated by customers
        ssl_certificate_key /root/server.key; #key generated by customers 
        location ^~ / { 
            proxy_set_header Host "<external access host>:443"; 
            proxy_pass https://suite-service;
       } 
 }
 
}
Replace the following placeholders with the related FQDNs and change your server certificate and server key paths:
<control plane node 1>: FQDN of the first control plane node
<control plane node 2>: FQDN of the second control plane node
<control plane node 3>: FQDN of the third control plane node
<external access host>: the external access host name of the suite
/root/server.crt and /root/server.key (for ports 5443 and 443): paths of the server certificate and server key files that you
have generated for nginx-smax (
server.crt
 and 
server.key
)
Configure nginx-cms
Make sure the Nginx configuration file (nginx.conf) contains the following settings.
http {
   upstream cms-service { #upstream for cms service 
       least_conn; 
       session_sticky;
       keepalive 32;
       server <control plane node 1>:443 max_fails=3 fail_timeout=10s; #control plane node 1 
       server <control plane node 2>:443 max_fails=3 fail_timeout=10s; #control plane node 2 
       server <control plane node 3>:443 max_fails=3 fail_timeout=10s; #control plane node 3 
} 
    server { #listen on 443 and proxy to cms service 
    underscores_in_headers on;
SMAX 2022.11
Page 
701
This PDF was generated on 25/02/2023 02:18:34 for your convenience. For the latest documentation, always see
https://docs.microfocus.com
.