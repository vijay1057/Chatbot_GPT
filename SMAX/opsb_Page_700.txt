http {
   
    upstream suite-service {     #upstream for suite service
        least_conn;
        session_sticky;
        keepalive 32;
        server <control plane node 1>:443 max_fails=3 fail_timeout=10s;     #control plane node 1
        server <control plane node 2>:443 max_fails=3 fail_timeout=10s;     #control plane node 2
        server <control plane node 3>:443 max_fails=3 fail_timeout=10s;     #control plane node 3
   }
   upstream cms-service { #upstream for cms service 
       least_conn; 
       session_sticky;
       keepalive 32;
       server <control plane node 1>:443 max_fails=3 fail_timeout=10s; #control plane node 1 
       server <control plane node 2>:443 max_fails=3 fail_timeout=10s; #control plane node 2 
       server <control plane node 3>:443 max_fails=3 fail_timeout=10s; #control plane node 3 
}
    server { #listen on 443 and proxy to suite service
        underscores_in_headers on;
        listen 443  ssl;
        ssl_certificate                         /root/server.crt;       #certificate generated by customers
        ssl_certificate_key                  /root/server.key;      #key generated by customers 
        ssl_protocols TLSv1.2;
        location ^~ / {
            proxy_set_header Host            "<
nginx-integration
>:443";
            proxy_pass                             https://suite-service;
            # Allow websocket connections       
            proxy_set_header Upgrade $http_upgrade;       
            proxy_set_header Connection "upgrade"; 
        }
    }
    server { #listen on 3443 and proxy to cms service 
        underscores_in_headers on;
        listen 3443 ssl; 
        ssl_certificate /root/server.crt; #certificate generated by customers 
        ssl_certificate_key /root/server.key; #key generated by customers 
        ssl_protocols TLSv1.2;
        location ^~ / { 
            proxy_set_header Host "<
nginx-integration
>:3443";
            proxy_pass https://cms-service; 
            # Allow websocket connections       
            proxy_set_header Upgrade $http_upgrade;       
            proxy_set_header Connection "upgrade";
        } 
     }
}
Replace the following placeholders with the related FQDNs and change your server certificate and server key paths:
<control plane node 1>: FQDN of the first control plane node
<control plane node 2>: FQDN of the second control plane node
<control plane node 3>: FQDN of the third control plane node
<nginx-integration>: FQDN of the integration Nginx server
/root/server.crt and /root/server.key (for ports 3443 and 443): paths of the server certificate and server key files that you
have generated for nginx-integration (
server.crt
 and 
server.key
)
Login URLs and integration URLs
The following table describes the login URLs and URLs for the CMS integration.
Type
Item
Value
Example
Login URL
OMT management portal URL
https://<external
 access host>:5443
https://smax.example-domain-
1.com:5443
Suite URL
https://<external
 access host>:443
https://smax.example-domain-
1.com:443
CMS URL
https://<nginx-cms
 host>:443/cms
https://cms.example-domain-
2.com:443/cms
Integration
URL
URL for CMS to access the
suite
https://<nginx-integration
 host>:443
https://intl.gtw.mf.com:443
URL for the suite to access
CMS
https://<nginx-integration
 host>:3443
https://intl.gtw.mf.com:3443
URL for the suite to access
CMS Gateway
https://<nginx-integration
host>:3443/cms-gateway
https://intl.gtw.mf.com:3443/
cms-
gateway
Tip
: You need the CMS Gateway URL when enabling the Native SACM and SAM solutions. See 
Enable Native SACM in
SMA
 and 
Enable SAM in SMAX
.
Option 2: Configure external load balancers in a network without DMZ
Perform the following steps.
Install the Nginx server
SMAX 2022.11
Page 
700
This PDF was generated on 25/02/2023 02:18:34 for your convenience. For the latest documentation, always see
https://docs.microfocus.com
.